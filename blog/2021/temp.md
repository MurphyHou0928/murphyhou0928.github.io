# Ⅴ、8255A

可编程并行通信接口8255A

## 1.8255A的内部结构

### ①数据端口A,B,C

``` markdown
- Port A
    端口A具有一个8位数据输入锁存器和一个数据输出锁存器/缓冲器；
    用端口A做输入口或输出口时，数据均受到锁存

- Port B
    端口B具有一个8位数据输入缓冲器和一个数据输出锁存器/缓冲器；

- Port C
    端口C具有一个8位数据输入缓冲器和一个数据输出锁存器/缓冲器，一般作为控制或状态信息端口
    当端口C作为输入口时，对数据不锁存
    当端口C作为输出口时，对数据进行锁存

使用中，A，B口为两个独立的数据输入输出端口，C口配合A口和B口的工作
C口常常通过控制命令被分成2个四位的端口，分别用来为端口A和B提供控制信号和状态信号
```

### ②A组控制和B组控制
``` markdown
控制端口A与端口C的高4位（PC7-PC4）
控制端口B与端口C的低4位（PC3-PC0）
```

### ③读/写控制逻辑电路
```markdown
功能：管理数据传输过程。

CS#-片选信号

A0、A1-端口选择信号

RD#-读信号

WR#-写信号

RESET-复位信号

读写控制逻辑：接收/CS信号以及来自地址总线的选择端口信号（A2 A1），还接收控制总线的信号/WR,/RD,REST，并将其组合成A和B组的控制信号
```


### ④数据总线缓冲器
```markdown
双向三态的8位数据缓冲器，8255A正是通过它与系统数据总线相连
```
## 2.芯片引脚信号

### 和外设相连的信号
```markdown
PA0－PA7：A口的8条输入输出信号线。



PB0－PB7：B口的8条输入输出信号线。



PC0－PC7：C口的8条输入输出信号线。
```
### 和CPU相连的信号


```markdown
D0－D7：双向数据信号线。和系统总线相连
/RD：读信号线。
/WR：写信号线。
/CS：片选信号线。当片选信号有效时，读信号和写信号才对8255A有效
A1、A0：口地址选择信号线。8255A有四个端口地址
00--A端口；01--B端口；10--C端口；11--控制口。
RESET：复位输入信号，复位时内部寄存器都被清除，同时，三个数据端口自动置为输入口
```


## 3.控制字

控制字分为两类：各端口的方式选择控制字和C端口的按位置1/置0控制字

```markdown
控制字的D7位称为标识位

D7=1--->方式选择控制字的标识符

D7=0------>C端口的按位置1/置0控制字的标识符
```

### 方式选择控制字
端口地址举例



说明

```markdown
8255A的[三种工作方式]
    方式0：基本的输入/输出方式
    方式1：选通的输入/输出方式
    方式2：双向传输方式

端口A可以工作在三种工作方式的任意一种，端口B只能工作在方式0或方式1，端口C则常配合端口A和B的工作，为这两个端口的输入/输出提供控制信号和状态信号
归为同一组的两个端口可以分别工作在输入或输出方式，不要求其工作同输入或输出
```



### 端口C置1/置0控制字

```markdown
8255A的端口C的各位均可用置1/置0控制字单独设置，因此C端口很适合做控制位使用

当8255A收到控制字时，就对最高位即标识位进行检测，D7=1，将此字节作为方式选择控制字写入控制寄存器，D7=0，将此字节作为端口C置1/置0控制字

C端口的按位置1/置0控制字注意：
    - C端口的按位置1/置0控制字尽管时对C端口进行操作，但必须写入控制端口，而不是写入C端口
    - D0位决定置1或置0,D0=0置0; D0=1置1
    - D3、D2、D1位决定了对C端口中的哪一位操作      
    - D4 5 6无影响
    - D7位必须为0 
```



## 4.工作方式

```
方式0：基本输入输出方式

	适用于无条件传送和查询方式的接口电路（传输方式转8086页面）

方式1：选通输入输出方式

	适用于查询和中断方式的接口电路

方式2：双向选通传送方式

	适用于双向传送数据的外设

	适用于查询和中断方式的接口电路
```
### ①方式0：基本的输入/输出方式

特点
```
- PA和PB可通过方式选择控制字规定为输入或者输出端口
- PC分为两个四位端口，高四位一个端口，第四位一个端口；这两个四位端口，也可以通过方式选择控制字规定为输入或输出端口

端口可作为输入口，也可作为输出口，各端口之间没有规定必然的联系。
可以有16种不同的组合，适用于多种不同的场合。 
```
时序

输入（CPU从8255A读取数据）时序



要求
```
发出读信号前，先发出地址信号，从而使得8255A的片选信号和端口选择信号A1         A0有效，于是启动8255A
输入数据要领先于读信号（要求在CPU发出读信号之前，外设已经将数据送到8255A的输入缓冲器中） 
```
输出（将数据有效传输到8255A）时序



要求
```
略
```
应用
```
用于连接简单外设。
适用于：
（1）无条件输入输出方式。
（2）查询输入输出方式：
A、B口作为8位数据的输入或输出口，C口的高/低4位分别定义为A、B口的控制位和状态  位，作为A（B）的应答信号。
应答信号不固定，可自由定义

应用实例：作为主机和打印机的接口
```



### ②方式1：选通的输入/输出方式

特点
```
- PA和PB用方式1进行输入/输出，端口C自动提供选通信号和应答信号
- PA和PB端口只有一个工作在方式1，那么PC一个端口中有3位被规定为配合方式1工作的信号，PC的另一个端口可以工作在方式0，PC的其他位以可工作在方式0，即作为输入/输出
- PA和PB都工作在方式1，那么PC中就需要6位用来作为配合方式1工作的信号，剩下的两位可以作为输入和输出
```
输入信号和输入时序

 

输出信号和输出时序

 

应用

```markdown
```



### ③方式2：双向传输方式

特点
```
方式2将方式1的选通输入输出功能组合成一个双向数据端口，可以发送数据和接收数据；
只有端口A可以工作于方式2，需要利用端口C的5个信号线，其作用与方式1相同；
方式2的数据输入过程与方式1的输入方式一样；
方式2的数据输出过程与方式1的输出方式有一点不同：数据输出时8255A不是在OBF#有效时向外设输出数据，而是在外设提供响应信号ACK#时才送出数据
```
时序

``` 
略
```




## 5.应用举例

